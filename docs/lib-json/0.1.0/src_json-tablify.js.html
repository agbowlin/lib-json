<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>src/json-tablify.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-lib-initext.html">lib-initext</a></li><li><a href="module-lib-json.html">lib-json</a><ul class='methods'><li data-type='method'><a href="module-lib-json.html#.Clone">Clone</a></li><li data-type='method'><a href="module-lib-json.html#.FindName">FindName</a></li><li data-type='method'><a href="module-lib-json.html#.FindValue">FindValue</a></li><li data-type='method'><a href="module-lib-json.html#.GetValue">GetValue</a></li><li data-type='method'><a href="module-lib-json.html#.HasPath">HasPath</a></li><li data-type='method'><a href="module-lib-json.html#.SetValue">SetValue</a></li><li data-type='method'><a href="module-lib-json.html#~Parse">Parse</a></li></ul></li><li></li><li></li><li></li><li></li><li></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">src/json-tablify.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";
/**
 * @module lib-json
 */

const LIB_STRINGIFY = require( './json-stringify.js' );


//---------------------------------------------------------------------
exports.Tablify = Tablify;


//---------------------------------------------------------------------
function Tablify ( Node, Options = {} )
{

	//---------------------------------------------------------------------
	function tablify_recurse ( Node, Depth, Options, Context = null ) 
	{
		let text = '';
		let stringify_options = LIB_STRINGIFY.STRINGIFY_OPTIONS_MINIMAL;
		stringify_options.identifier_quote = '';
		stringify_options.always_quote_identifiers = false;
		stringify_options.literal_quote = '';
		stringify_options.space_char = ' ';

		if ( Depth > Options.max_tablify_depth )
		{
			return LIB_STRINGIFY.Stringify( Node, stringify_options );
		}

		if ( typeof Node === 'undefined' )
		{
			// return '';
		}
		else if ( typeof Node === 'boolean' )
		{
			text += Node.toString();
		}
		else if ( typeof Node === 'number' )
		{
			text += Node.toString();
		}
		else if ( typeof Node === 'bigint' )
		{
			text += Node.toString();
		}
		else if ( typeof Node === 'string' )
		{
			text += Node.toString();
		}
		else if ( typeof Node === 'symbol' )
		{
			// return '';
		}
		else if ( typeof Node === 'function' )
		{
			// return '';
		}
		else if ( typeof Node === 'object' )
		{
			if ( Node === null )
			{
				text += 'null';
			}
			else if ( Array.isArray( Node ) )
			{
				if ( Context === 'field-value' )
				{
					text += Options.eol_char;
				}
				if ( Node.length === 0 )
				{
					return '';
				}
				if (
					( typeof Node[ 0 ] === 'object' )
					&amp;&amp; ( Node[ 0 ] !== null )
				)
				{
					if ( Array.isArray( Node[ 0 ] ) )
					{
						// Table of arrays.
						for ( let index = 0; index &lt; Node.length; index++ )
						{
							text += Options.tab_char.repeat( Depth );
							text += LIB_STRINGIFY.Stringify( Node[ index ], stringify_options );
							if ( index &lt; ( Node.length - 1 ) ) { text += Options.eol_char; }
						}
					}
					else
					{
						// Table of objects.
						// Get column widths.
						let keys = Object.keys( Node[ 0 ] );
						let col_widths = keys.map( key => key.length );
						for ( let index = 0; index &lt; Node.length; index++ )
						{
							for ( let col_index = 0; col_index &lt; keys.length; col_index++ )
							{
								let value = LIB_STRINGIFY.Stringify( Node[ index ][ keys[ col_index ] ], stringify_options );
								if ( col_widths[ col_index ] &lt; value.length ) { col_widths[ col_index ] = value.length; }
							}
						}
						// Display column headers.
						text += Options.tab_char.repeat( Depth );
						for ( let col_index = 0; col_index &lt; keys.length; col_index++ )
						{
							if ( col_index > 0 ) { text += ' | '; }
							let value = keys[ col_index ];
							text += value;
							text += ''.padEnd( col_widths[ col_index ] - value.length );
						}
						text += Options.eol_char;
						// Display column header line.
						text += Options.tab_char.repeat( Depth );
						for ( let col_index = 0; col_index &lt; keys.length; col_index++ )
						{
							if ( col_index > 0 ) { text += '-+-'; }
							text += '-'.repeat( col_widths[ col_index ] );
						}
						text += Options.eol_char;
						// Display values.
						for ( let index = 0; index &lt; Node.length; index++ )
						{
							text += Options.tab_char.repeat( Depth );
							for ( let col_index = 0; col_index &lt; keys.length; col_index++ )
							{
								if ( col_index > 0 ) { text += ' | '; }
								let value = LIB_STRINGIFY.Stringify( Node[ index ][ keys[ col_index ] ], stringify_options );
								text += value;
								text += ''.padEnd( col_widths[ col_index ] - value.length );
							}
							if ( index &lt; ( Node.length - 1 ) ) { text += Options.eol_char; }
						}
					}
				}
				else
				{
					// Table of primiive values.
					for ( let index = 0; index &lt; Node.length; index++ )
					{
						text += Options.tab_char.repeat( Depth );
						text += tablify_recurse( Node[ index ], Depth + 1, Options, 'array-element' );
						if ( index &lt; ( Node.length - 1 ) ) { text += Options.eol_char; }
					}
				}
			}
			else
			{
				if ( Context === 'field-value' )
				{
					text += Options.eol_char;
				}
				// Get the object keys.
				let keys = Object.keys( Node );
				// Get the max column width for the keys.
				let max_key_length = 0;
				keys.forEach( ( key ) => { if ( key.length > max_key_length ) { max_key_length = key.length; } } );
				// Display Values.
				for ( let index = 0; index &lt; keys.length; index++ )
				{
					let key = keys[ index ];
					text += Options.tab_char.repeat( Depth );
					text += `${ key }${ ''.padEnd( max_key_length - key.length ) } : `;
					text += tablify_recurse( Node[ key ], Depth + 1, Options, 'field-value' );
					if ( index &lt; ( key.length - 1 ) ) { text += Options.eol_char; }
				}
			}
		}

		return text;
	}


	//---------------------------------------------------------------------
	Options = Options ? Options : {};
	Options.literal_quote = Options.literal_quote ? Options.literal_quote : `"`;
	Options.eol_char = Options.eol_char ? Options.eol_char : `\n`;
	Options.tab_char = Options.tab_char ? Options.tab_char : `    `;
	Options.max_tablify_depth = Options.max_tablify_depth ? Options.max_tablify_depth : 2;


	//---------------------------------------------------------------------
	return tablify_recurse( Node, 0, Options, null );
}


// let text = tablify(
// 	{
// 		"Report Name": 'My Super Technical Report',
// 		"Timestamp": ( new Date() ).toString(),
// 		"Author": 'Computer Algorithm',
// 		"Raw Data": [ 0.95, 0.83, 0.87 ],
// 		"More Raw Data":
// 			[
// 				[ 1, 2, 3 ],
// 				[ 0.95, 0.83, 0.87 ],
// 			],
// 		"Results":
// 			[
// 				{
// 					"Trial Number": 1,
// 					"Source": 'Category A',
// 					"Result": 0.95,
// 				},
// 				{
// 					"Trial Number": 2,
// 					"Source": 'Category B',
// 					"Result": 0.83,
// 				},
// 				{
// 					"Trial Number": 3,
// 					"Source": 'Category C',
// 					"Result": 0.87,
// 				},
// 			],
// 		"Summary":
// 		{
// 			"Number of Trials": 3,
// 			"Average Result": 0.8833,
// 		},
// 	}
// );
// console.log( text );
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Tue Jun 23 2020 00:47:52 GMT-0500 (Central Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
